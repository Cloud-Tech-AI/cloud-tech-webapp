version: '3'
services:
  redis:
    image: 392488130328.dkr.ecr.ap-south-1.amazonaws.com/cloudtech:latest
    ports:
      - 6379:6379
    command: redis-server

  django-app:
    env_file:
      - cloudtech_project/.env
    image: 392488130328.dkr.ecr.ap-south-1.amazonaws.com/cloudtech:latest
    ports:
      - 8000:8000
    command: python manage.py runserver 0.0.0.0:8000

  celery-worker:
    env_file:
      - cloudtech_project/.env
    image: 392488130328.dkr.ecr.ap-south-1.amazonaws.com/cloudtech:latest
    command: celery -A cloudtech_project worker -l info
    depends_on:
      - redis
